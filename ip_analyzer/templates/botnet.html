{% extends "base.html" %}

{% block title %}Botnety{% endblock %}

{% block content %}
  <h2>ðŸ¤– Analiza botnetÃ³w</h2>

  <form method="get" class="mb-4" style="max-width: 300px;">
    <label for="attackSelect" class="form-label">Wybierz atak:</label>
    <select id="attackSelect" name="attack" class="form-select" onchange="this.form.submit()">
      <option value="">â€” Wszystkie ataki â€”</option>
      {% for label in attack_labels %}
        <option value="{{ label }}" {% if label == selected_attack %}selected{% endif %}>
          {{ label }}
        </option>
      {% endfor %}
    </select>
  </form>

  {% if botnets %}
    <table class="table table-striped table-bordered table-hover">
      <thead class="table-dark">
        <tr>
          <th>ASN</th>
          <th>Kraj</th>
          <th>Liczba IP</th>
          <th>Adresy IP</th>
        </tr>
      </thead>
      <tbody>
        {% for group in botnets %}
          <tr>
            <td>{{ group.asn }}</td>
            <td>{{ group.country }}</td>
            <td>{{ group.count }}</td>
            <td>
              <ul class="mb-0">
                {% for ip in group.ips %}
                  <li>{{ ip.ip_address }}</li>
                {% endfor %}
              </ul>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="alert alert-info">
      Brak wykrytych potencjalnych botnetÃ³w{% if selected_attack %} dla ataku "{{ selected_attack }}"{% endif %}.
    </div>
  {% endif %}
{% endblock %}
